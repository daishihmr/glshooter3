/*
 * webgl shooting game v0.0.0
 * http://www.dev7.jp
 * 
 * The MIT License (MIT)
 * Copyright © 2014 daishi_hmr, dev7.jp
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy of this software and
 * associated documentation files (the “Software”), to deal in the Software without restriction, including
 * without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
 * of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following
 * conditions:
 * 
 * The above copyright notice and this permission notice shall be included in all copies or substantial portions
 * of the Software.
 * 
 * THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */


var gls3={};gls3.W=360,gls3.H=480,gls3.assets={titleFont:"fonts/Teko/Teko-Bold.ttf",uiFont:"fonts/Oxygen/Oxygen-Regular.ttf",numberFont:"fonts/UbuntuMono/UbuntuMono-Bold.ttf",building:{url:"images/building.js",type:"three"},bg:{url:"images/random.js",type:"three"}},tm.define("tm.asset.WebFont",{superClass:"tm.event.EventDispatcher",init:function(a,b){this.superInit();var c=tm.dom.Element("body").create("span");c.style.set("fontFamily","'{0}', 'monospace'".format(b)).set("color","rgba(0, 0, 0, 0)").set("fontSize","40px"),c.text="QW@HhsXJ=/()あいうえお＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝＝";var d=c.element.offsetWidth,e=tm.dom.Element("head").create("style");e.text="@font-face { font-family: '{0}'; src: url({1}) format('truetype'); }".format(b,a);var f=function(){c.element.offsetWidth!==d?(c.remove(),this.flare("load"),console.debug("webfont loaded",a,b)):setTimeout(f,100)}.bind(this);setTimeout(f,100)}}),tm.asset.Loader.register("ttf",function(a,b){var c=tm.asset.WebFont(a,b);return c}),tm.define("tm.asset.ThreeJSON",{superClass:"tm.event.EventDispatcher",init:function(a){this.superInit(),this.mesh=null,null===tm.asset.ThreeJSON.loader&&(tm.asset.ThreeJSON.loader=new THREE.JSONLoader),tm.asset.ThreeJSON.loader.load(a,function(a,b){this.load(a,b),this.flare("load")}.bind(this))},load:function(a,b){b[0].shading=THREE.FlatShading,this.mesh=new THREE.Mesh(a,new THREE.MeshFaceMaterial(b))}}),tm.asset.ThreeJSON.loader=null,tm.asset.Loader.register("three",function(a){var b=tm.asset.ThreeJSON(a);return b}),tm.define("tm.hybrid.HybridApp",{superClass:"tm.display.CanvasApp",init:function(a){this.superInit(a),this.setupThree(),this.background="transparent"},setupThree:function(){this.threeRenderer=new THREE.WebGLRenderer({antialias:!0}),this.threeRenderer.shadowMapEnabled=!0,this.element.parentNode&&this.element.parentNode.appendChild(this.threeRenderer.domElement),this.threeCanvas=this.threeRenderer.domElement},fitWindow:function(a){var b=function(){a=void 0===a?!0:a;var b=this.threeCanvas,c=b.style;c.position="absolute",c.margin="auto",c.left="0px",c.top="0px",c.bottom="0px",c.right="0px";var d=b.width/window.innerWidth,e=b.height/window.innerHeight,f=b.height/b.width;d>e?(c.width=innerWidth+"px",c.height=innerWidth*f+"px"):(c.width=innerHeight/f+"px",c.height=innerHeight+"px")}.bind(this);return b(),a&&window.addEventListener("resize",b,!1),tm.display.CanvasApp.prototype.fitWindow.call(this,a)},_update:function(){tm.app.BaseApp.prototype._update.call(this);var a=this.currentScene;this.awake&&a instanceof tm.hybrid.HybridScene&&(this.updater.update(a.three.camera),this.updater.update(a.three))},_draw:function(){tm.display.CanvasApp.prototype._draw.call(this);var a=this.currentScene;a instanceof tm.hybrid.HybridScene&&a.render(this.threeRenderer)},resize:function(a,b){this.threeRenderer.setSize(a,b);var c=this.currentScene;return c instanceof tm.hybrid.HybridScene&&(c.three.camera.aspect=a/b),tm.display.CanvasApp.prototype.resize.call(this,a,b)}}),tm.define("tm.hybrid.HybridScene",{superClass:"tm.app.Scene",init:function(){this.superInit(),this.two=this,this.three=tm.hybrid.HybridScene.Three(),this.effectComposer=null,this.on("enter",function(a){this.camera.aspect=a.app.width/a.app.height})},render:function(a){a.render(this.three.scene,this.three.camera.threeObject)}}),tm.hybrid.HybridScene.prototype.accessor("camera",{get:function(){return this.three.camera},set:function(a){this.three.camera=a}}),tm.hybrid.HybridScene.prototype.accessor("ambientLight",{get:function(){return this.three.ambientLight},set:function(a){this.three.ambientLight=a}}),tm.hybrid.HybridScene.prototype.accessor("directionalLight",{get:function(){return this.three.directionalLight},set:function(a){this.three.directionalLight=a}}),tm.define("tm.hybrid.HybridScene.Three",{superClass:"tm.hybrid.ThreeElement",init:function(){this.superInit(new THREE.Scene),this.scene=this.threeObject,this.camera=tm.hybrid.Camera(),this.camera.z=7}}),tm.hybrid.HybridScene.prototype.accessor("fog",{get:function(){return this.three.scene.fog},set:function(a){this.three.scene.fog=a}}),tm.hybrid.HybridScene.prototype.accessor("overrideMaterial",{get:function(){return this.three.scene.overrideMaterial},set:function(a){this.three.scene.overrideMaterial=a}}),tm.hybrid.HybridScene.prototype.accessor("autoUpdate",{get:function(){return this.three.scene.autoUpdate},set:function(a){this.three.scene.autoUpdate=a}}),tm.define("tm.hybrid.ThreeElement",{superClass:"tm.app.Element",init:function(a){this.superInit(),this.threeObject=a||new THREE.Object3D},addChild:function(a){a.parent&&a.remove(),a.parent=this,this.children.push(a),a instanceof tm.hybrid.ThreeElement&&this.threeObject.add(a.threeObject);var b=tm.event.Event("added");return a.dispatchEvent(b),a},removeChild:function(a){var b=this.children.indexOf(a);if(-1!=b){this.children.splice(b,1),a instanceof tm.hybrid.ThreeElement&&this.threeObject.remove(a.threeObject);var c=tm.event.Event("removed");a.dispatchEvent(c)}},setX:function(a){return this.x=a,this},setY:function(a){return this.y=a,this},setZ:function(a){return this.z=a,this},setPosition:function(a,b,c){return this.x=a,this.y=b,this.z=c,this},setRotation:function(a,b,c){return this.rotationX=a,this.rotationY=b,this.rotationZ=c,this},setRotationX:function(a){return this.rotationX=a,this},setRotationY:function(a){return this.rotationY=a,this},setRotationZ:function(a){return this.rotationZ=a,this},setScale:function(a,b,c){return 1===arguments.length&&(b=a,c=a),this.scaleX=a,this.scaleY=b,this.scaleZ=c,this},show:function(){return this.visible=!0,this},hide:function(){return this.visible=!1,this}}),tm.hybrid.ThreeElement.prototype.accessor("id",{get:function(){return this.threeObject.id},set:function(a){this.threeObject.id=a}}),tm.hybrid.ThreeElement.prototype.accessor("uuid",{get:function(){return this.threeObject.uuid},set:function(a){this.threeObject.uuid=a}}),tm.hybrid.ThreeElement.prototype.accessor("name",{get:function(){return this.threeObject.name},set:function(a){this.threeObject.name=a}}),tm.hybrid.ThreeElement.prototype.accessor("position",{get:function(){return this.threeObject.position},set:function(a){this.threeObject.position=a}}),tm.hybrid.ThreeElement.prototype.accessor("x",{get:function(){return this.threeObject.position.x},set:function(a){this.threeObject.position.x=a}}),tm.hybrid.ThreeElement.prototype.accessor("y",{get:function(){return this.threeObject.position.y},set:function(a){this.threeObject.position.y=a}}),tm.hybrid.ThreeElement.prototype.accessor("z",{get:function(){return this.threeObject.position.z},set:function(a){this.threeObject.position.z=a}}),tm.hybrid.ThreeElement.prototype.accessor("scale",{get:function(){return this.threeObject.scale},set:function(a){this.threeObject.scale=a}}),tm.hybrid.ThreeElement.prototype.accessor("scaleX",{get:function(){return this.threeObject.scale.x},set:function(a){this.threeObject.scale.x=a}}),tm.hybrid.ThreeElement.prototype.accessor("scaleY",{get:function(){return this.threeObject.scale.y},set:function(a){this.threeObject.scale.y=a}}),tm.hybrid.ThreeElement.prototype.accessor("scaleZ",{get:function(){return this.threeObject.scale.z},set:function(a){this.threeObject.scale.z=a}}),tm.hybrid.ThreeElement.prototype.accessor("rotation",{get:function(){return this.threeObject.rotation},set:function(a){this.threeObject.rotation=a}}),tm.hybrid.ThreeElement.prototype.accessor("eulerOrder",{get:function(){return this.threeObject.eulerOrder},set:function(a){this.threeObject.eulerOrder=a}}),tm.hybrid.ThreeElement.prototype.accessor("rotationX",{get:function(){return this.threeObject.rotation.x*Math.RAD_TO_DEG},set:function(a){this.threeObject.rotation.x=a*Math.DEG_TO_RAD}}),tm.hybrid.ThreeElement.prototype.accessor("rotationY",{get:function(){return this.threeObject.rotation.y*Math.RAD_TO_DEG},set:function(a){this.threeObject.rotation.y=a*Math.DEG_TO_RAD}}),tm.hybrid.ThreeElement.prototype.accessor("rotationZ",{get:function(){return this.threeObject.rotation.z*Math.RAD_TO_DEG},set:function(a){this.threeObject.rotation.z=a*Math.DEG_TO_RAD}}),tm.hybrid.ThreeElement.prototype.accessor("up",{get:function(){return this.threeObject.up},set:function(a){this.threeObject.up=a}}),tm.hybrid.ThreeElement.prototype.accessor("useQuaternion",{get:function(){return this.threeObject.useQuaternion},set:function(a){this.threeObject.useQuaternion=a}}),tm.hybrid.ThreeElement.prototype.accessor("quaternion",{get:function(){return this.threeObject.quaternion},set:function(a){this.threeObject.quaternion=a}}),tm.hybrid.ThreeElement.prototype.accessor("visible",{get:function(){return this.threeObject.visible},set:function(a){this.threeObject.visible=a}}),tm.hybrid.ThreeElement.defineInstanceMethod("setVisible",function(a){return this.visible=a,this}),tm.hybrid.ThreeElement.prototype.accessor("castShadow",{get:function(){return this.threeObject.castShadow},set:function(a){this.threeObject.castShadow=a}}),tm.hybrid.ThreeElement.defineInstanceMethod("setCastShadow",function(a){return this.castShadow=a,this}),tm.hybrid.ThreeElement.prototype.accessor("receiveShadow",{get:function(){return this.threeObject.receiveShadow},set:function(a){this.threeObject.receiveShadow=a}}),tm.hybrid.ThreeElement.defineInstanceMethod("setReceiveShadow",function(a){return this.receiveShadow=a,this}),tm.hybrid.ThreeElement.prototype.accessor("frustumCulled",{get:function(){return this.threeObject.frustumCulled},set:function(a){this.threeObject.frustumCulled=a}}),tm.hybrid.ThreeElement.prototype.accessor("matrixAutoUpdate",{get:function(){return this.threeObject.matrixAutoUpdate},set:function(a){this.threeObject.matrixAutoUpdate=a}}),tm.hybrid.ThreeElement.prototype.accessor("matrixWorldNeedsUpdate",{get:function(){return this.threeObject.matrixWorldNeedsUpdate},set:function(a){this.threeObject.matrixWorldNeedsUpdate=a}}),tm.hybrid.ThreeElement.prototype.accessor("rotationAutoUpdate",{get:function(){return this.threeObject.rotationAutoUpdate},set:function(a){this.threeObject.rotationAutoUpdate=a}}),tm.hybrid.ThreeElement.prototype.accessor("userData",{get:function(){return this.threeObject.userData},set:function(a){this.threeObject.userData=a}}),tm.hybrid.ThreeElement.prototype.accessor("matrixWorld",{get:function(){return this.threeObject.matrixWorld},set:function(a){this.threeObject.matrixWorld=a}}),tm.hybrid.ThreeElement.defineInstanceMethod("applyMatrix",function(a){return this.threeObject.applyMatrix(a),this}),tm.hybrid.ThreeElement.defineInstanceMethod("translateX",function(a){return this.threeObject.translateX(a),this}),tm.hybrid.ThreeElement.defineInstanceMethod("translateY",function(a){return this.threeObject.translateY(a),this}),tm.hybrid.ThreeElement.defineInstanceMethod("translateZ",function(a){return this.threeObject.translateZ(a),this}),tm.hybrid.ThreeElement.defineInstanceMethod("localToWorld",function(a){return this.threeObject.localToWorld(a),this}),tm.hybrid.ThreeElement.defineInstanceMethod("worldToLocal",function(a){return this.threeObject.worldToLocal(a),this}),tm.hybrid.ThreeElement.defineInstanceMethod("lookAt",function(a){return this.threeObject.lookAt(a),this}),tm.hybrid.ThreeElement.defineInstanceMethod("updateMatrix",function(){return this.threeObject.updateMatrix(),this}),tm.hybrid.ThreeElement.defineInstanceMethod("updateMatrixWorld",function(a){return this.threeObject.updateMatrixWorld(a),this}),tm.hybrid.ThreeElement.defineInstanceMethod("getObjectByName",function(a,b){return this.threeObject.getObjectByName(a,b)}),tm.hybrid.ThreeElement.defineInstanceMethod("getObjectById",function(a,b){return this.threeObject.getObjectById(a,b)}),tm.hybrid.ThreeElement.defineInstanceMethod("translateOnAxis",function(a,b){return this.threeObject.translateOnAxis(a,b),this}),tm.hybrid.ThreeElement.defineInstanceMethod("rotateOnAxis",function(a,b){return this.threeObject.rotateOnAxis(a,b),this}),tm.define("tm.hybrid.Camera",{superClass:"tm.hybrid.ThreeElement",init:function(){this.superInit(new THREE.PerspectiveCamera(45,1,1,1e4))}}),tm.hybrid.Camera.prototype.accessor("matrixWorldInverse",{get:function(){return this.threeObject.matrixWorldInverse},set:function(a){this.threeObject.matrixWorldInverse=a}}),tm.hybrid.Camera.prototype.accessor("projectionMatrix",{get:function(){return this.threeObject.projectionMatrix},set:function(a){this.threeObject.projectionMatrix=a}}),tm.hybrid.Camera.prototype.accessor("fov",{get:function(){return this.threeObject.fov},set:function(a){this.threeObject.fov=a,this.threeObject.updateProjectionMatrix()}}),tm.hybrid.Camera.prototype.accessor("aspect",{get:function(){return this.threeObject.aspect},set:function(a){this.threeObject.aspect=a,this.threeObject.updateProjectionMatrix()}}),tm.hybrid.Camera.prototype.accessor("near",{get:function(){return this.threeObject.near},set:function(a){this.threeObject.near=a,this.threeObject.updateProjectionMatrix()}}),tm.hybrid.Camera.prototype.accessor("far",{get:function(){return this.threeObject.far},set:function(a){this.threeObject.far=a,this.threeObject.updateProjectionMatrix()}}),tm.define("tm.hybrid.DirectionalLight",{superClass:"tm.hybrid.ThreeElement",init:function(a,b){this.superInit(new THREE.DirectionalLight(a,b))}}),tm.hybrid.DirectionalLight.prototype.accessor("target",{get:function(){return this.threeObject.target},set:function(a){this.threeObject.target=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setTarget",function(a){return this.target=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getTarget",function(){return this.target}),tm.hybrid.DirectionalLight.prototype.accessor("intensity",{get:function(){return this.threeObject.intensity},set:function(a){this.threeObject.intensity=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setIntensity",function(a){return this.intensity=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getIntensity",function(){return this.intensity}),tm.hybrid.DirectionalLight.prototype.accessor("onlyShadow",{get:function(){return this.threeObject.onlyShadow},set:function(a){this.threeObject.onlyShadow=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setOnlyShadow",function(a){return this.onlyShadow=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getOnlyShadow",function(){return this.onlyShadow}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCameraNear",{get:function(){return this.threeObject.shadowCameraNear},set:function(a){this.threeObject.shadowCameraNear=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCameraNear",function(a){return this.shadowCameraNear=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCameraNear",function(){return this.shadowCameraNear}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCameraFar",{get:function(){return this.threeObject.shadowCameraFar},set:function(a){this.threeObject.shadowCameraFar=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCameraFar",function(a){return this.shadowCameraFar=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCameraFar",function(){return this.shadowCameraFar}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCameraLeft",{get:function(){return this.threeObject.shadowCameraLeft},set:function(a){this.threeObject.shadowCameraLeft=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCameraLeft",function(a){return this.shadowCameraLeft=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCameraLeft",function(){return this.shadowCameraLeft}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCameraRight",{get:function(){return this.threeObject.shadowCameraRight},set:function(a){this.threeObject.shadowCameraRight=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCameraRight",function(a){return this.shadowCameraRight=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCameraRight",function(){return this.shadowCameraRight}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCameraTop",{get:function(){return this.threeObject.shadowCameraTop},set:function(a){this.threeObject.shadowCameraTop=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCameraTop",function(a){return this.shadowCameraTop=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCameraTop",function(){return this.shadowCameraTop}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCameraBottom",{get:function(){return this.threeObject.shadowCameraBottom},set:function(a){this.threeObject.shadowCameraBottom=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCameraBottom",function(a){return this.shadowCameraBottom=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCameraBottom",function(){return this.shadowCameraBottom}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCameraVisible",{get:function(){return this.threeObject.shadowCameraVisible},set:function(a){this.threeObject.shadowCameraVisible=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCameraVisible",function(a){return this.shadowCameraVisible=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCameraVisible",function(){return this.shadowCameraVisible}),tm.hybrid.DirectionalLight.prototype.accessor("shadowBias",{get:function(){return this.threeObject.shadowBias},set:function(a){this.threeObject.shadowBias=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowBias",function(a){return this.shadowBias=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowBias",function(){return this.shadowBias}),tm.hybrid.DirectionalLight.prototype.accessor("shadowDarkness",{get:function(){return this.threeObject.shadowDarkness},set:function(a){this.threeObject.shadowDarkness=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowDarkness",function(a){return this.shadowDarkness=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowDarkness",function(){return this.shadowDarkness}),tm.hybrid.DirectionalLight.prototype.accessor("shadowMapWidth",{get:function(){return this.threeObject.shadowMapWidth},set:function(a){this.threeObject.shadowMapWidth=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowMapWidth",function(a){return this.shadowMapWidth=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowMapWidth",function(){return this.shadowMapWidth}),tm.hybrid.DirectionalLight.prototype.accessor("shadowMapHeight",{get:function(){return this.threeObject.shadowMapHeight},set:function(a){this.threeObject.shadowMapHeight=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowMapHeight",function(a){return this.shadowMapHeight=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowMapHeight",function(){return this.shadowMapHeight}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCascade",{get:function(){return this.threeObject.shadowCascade},set:function(a){this.threeObject.shadowCascade=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCascade",function(a){return this.shadowCascade=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCascade",function(){return this.shadowCascade}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCascadeOffset",{get:function(){return this.threeObject.shadowCascadeOffset},set:function(a){this.threeObject.shadowCascadeOffset=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCascadeOffset",function(a){return this.shadowCascadeOffset=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCascadeOffset",function(){return this.shadowCascadeOffset}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCascadeCount",{get:function(){return this.threeObject.shadowCascadeCount},set:function(a){this.threeObject.shadowCascadeCount=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCascadeCount",function(a){return this.shadowCascadeCount=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCascadeCount",function(){return this.shadowCascadeCount}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCascadeBias",{get:function(){return this.threeObject.shadowCascadeBias},set:function(a){this.threeObject.shadowCascadeBias=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCascadeBias",function(a){return this.shadowCascadeBias=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCascadeBias",function(){return this.shadowCascadeBias}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCascadeWidth",{get:function(){return this.threeObject.shadowCascadeWidth},set:function(a){this.threeObject.shadowCascadeWidth=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCascadeWidth",function(a){return this.shadowCascadeWidth=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCascadeWidth",function(){return this.shadowCascadeWidth}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCascadeHeight",{get:function(){return this.threeObject.shadowCascadeHeight},set:function(a){this.threeObject.shadowCascadeHeight=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCascadeHeight",function(a){return this.shadowCascadeHeight=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCascadeHeight",function(){return this.shadowCascadeHeight}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCascadeNearZ",{get:function(){return this.threeObject.shadowCascadeNearZ},set:function(a){this.threeObject.shadowCascadeNearZ=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCascadeNearZ",function(a){return this.shadowCascadeNearZ=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCascadeNearZ",function(){return this.shadowCascadeNearZ}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCascadeFarZ",{get:function(){return this.threeObject.shadowCascadeFarZ},set:function(a){this.threeObject.shadowCascadeFarZ=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCascadeFarZ",function(a){return this.shadowCascadeFarZ=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCascadeFarZ",function(){return this.shadowCascadeFarZ}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCascadeArray",{get:function(){return this.threeObject.shadowCascadeArray},set:function(a){this.threeObject.shadowCascadeArray=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCascadeArray",function(a){return this.shadowCascadeArray=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCascadeArray",function(){return this.shadowCascadeArray}),tm.hybrid.DirectionalLight.prototype.accessor("shadowMap",{get:function(){return this.threeObject.shadowMap},set:function(a){this.threeObject.shadowMap=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowMap",function(a){return this.shadowMap=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowMap",function(){return this.shadowMap}),tm.hybrid.DirectionalLight.prototype.accessor("shadowMapSize",{get:function(){return this.threeObject.shadowMapSize},set:function(a){this.threeObject.shadowMapSize=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowMapSize",function(a){return this.shadowMapSize=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowMapSize",function(){return this.shadowMapSize}),tm.hybrid.DirectionalLight.prototype.accessor("shadowCamera",{get:function(){return this.threeObject.shadowCamera},set:function(a){this.threeObject.shadowCamera=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowCamera",function(a){return this.shadowCamera=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowCamera",function(){return this.shadowCamera}),tm.hybrid.DirectionalLight.prototype.accessor("shadowMatrix",{get:function(){return this.threeObject.shadowMatrix},set:function(a){this.threeObject.shadowMatrix=a}}),tm.hybrid.DirectionalLight.defineInstanceMethod("setShadowMatrix",function(a){return this.shadowMatrix=a,this}),tm.hybrid.DirectionalLight.defineInstanceMethod("getShadowMatrix",function(){return this.shadowMatrix}),tm.define("tm.hybrid.Mesh",{superClass:"tm.hybrid.ThreeElement",init:function(a){if("string"==typeof a){var b=tm.asset.Manager.get(a);b?this.superInit(b.mesh.clone()):console.error("アセット'{0}'がないよ".format(a))}else a instanceof THREE.Mesh&&this.superInit(a)}}),tm.hybrid.Mesh.prototype.getMorphTargetIndexByName=function(a){return this.threeObject.getMorphTargetIndexByName(a),this},tm.hybrid.Mesh.prototype.updateMorphTargets=function(){return this.threeObject.updateMorphTargets(),this},tm.define("tm.hybrid.Sprite",{superClass:"tm.hybrid.ThreeElement",init:function(a,b,c){"string"==typeof a?this.texture=tm.asset.Manager.get(a):a?this.texture=a:console.error("アセット'{0}'がないよ".format(a)),b=b||1,c=c||1,this.superInit()}}),tm.define("gls3.GameScene",{superClass:"tm.hybrid.HybridScene",init:function(){this.superInit(),this.on("enter",function(a){var b=this.effectComposer=new THREE.EffectComposer(a.app.threeRenderer);b.addPass(new THREE.RenderPass(this.three.scene,this.three.camera.threeObject),new THREE.WebGLRenderTarget(a.app.width,a.app.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1}));var c=new THREE.ShaderPass(THREE.CopyShader);b.addPass(c),c.renderToScreen=!0})},render:function(){this.effectComposer.render()}}),tm.main(function(){tm.dom.Element("body").style.set("backgroundColor","hsl(240, 40%, 10%)"),gls3.app=tm.hybrid.HybridApp(),tm.util.Script.loadStats().on("load",function(){gls3.app.enableStats()});var a=tm.dom.Element(gls3.app.element),b=tm.dom.Element(gls3.app.threeCanvas);b.style.set("backgroundColor","black"),tm.dom.Element("body").prepend(a).prepend(b),gls3.app.fps=60,gls3.app.resize(gls3.W,gls3.H).fitWindow(),gls3.app.pushScene(tm.ui.LoadingScene({nextScene:Main,width:gls3.W,height:gls3.H,assets:gls3.assets})),gls3.app.run()}),tm.define("Main",{superClass:"gls3.GameScene",init:function(){var a=this;this.superInit(),this.fromJSON({children:{}});var b=(tm.hybrid.Mesh("bg").on("enterframe",function(){this.z+=1}).setX(100).setScale(80).setReceiveShadow(!0).addChildTo(a.three),tm.hybrid.ThreeElement().setY(200).on("enterframe",function(){}).addChildTo(a.three));this.camera.setPosition(0,2500,1).lookAt(b).addChildTo(b);tm.hybrid.Mesh(new THREE.Mesh(new THREE.BoxGeometry(200,200,200),new THREE.MeshLambertMaterial({color:1052800,ambient:65793}))).setCastShadow(!0).on("enterframe",function(a){this.rotationZ+=2;var b=a.app.keyboard.getKeyDirection().mul(20);this.x+=b.x,this.z+=b.y}).addChildTo(b);tm.hybrid.ThreeElement(new THREE.AmbientLight(16777215,.5)).addChildTo(b);tm.hybrid.DirectionalLight(16777215,2).setCastShadow(!0).setPosition(1,1,1).addChildTo(a.three)}});
//# sourceMappingURL=glshooter3.min.js.map